webpackJsonp([16],{gVvj:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("woOf"),o=r.n(a),i=r("Xxa5"),n=r.n(i),l=r("exGp"),s=r.n(l),c=r("CWES"),d={props:{initData:{type:Object}},data:function(){return{formData:o()({},this.initData),formRules:{orgName:[{required:!0,message:"请输入组织名称 !",trigger:"change"}],orgCode:[{required:!0,message:"请输入唯一编号 !",trigger:"change"}]}}},methods:{handleUpdateData:function(){var e=this;return s()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$refs.editForm.validate();case 3:e.$emit("updataData",e.formData),e.$emit("close"),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}},t,e,[[0,7]])}))()}}},m={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("flex-container",[r("el-form",{ref:"editForm",staticClass:"form-style-line",attrs:{model:e.formData,rules:e.formRules,"label-position":"right","label-width":"90px"}},[r("el-row",{attrs:{span:12}},[r("el-col",[r("el-form-item",{attrs:{label:"组织名称 :",prop:"orgName"}},[r("el-input",{attrs:{maxlength:"10","show-word-limit":""},model:{value:e.formData.orgName,callback:function(t){e.$set(e.formData,"orgName",t)},expression:"formData.orgName"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"唯一编号 :",prop:"orgCode"}},[r("el-input",{attrs:{maxlength:"50","show-word-limit":""},model:{value:e.formData.orgCode,callback:function(t){e.$set(e.formData,"orgCode",t)},expression:"formData.orgCode"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"组织简称 :",prop:"orgBrfName"}},[r("el-input",{attrs:{maxlength:"10","show-word-limit":""},model:{value:e.formData.orgBrfName,callback:function(t){e.$set(e.formData,"orgBrfName",t)},expression:"formData.orgBrfName"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"负责人 :",prop:"orgMast"}},[r("el-input",{model:{value:e.formData.orgMast,callback:function(t){e.$set(e.formData,"orgMast",t)},expression:"formData.orgMast"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"组织地址 :",prop:"orgAddr"}},[r("el-input",{model:{value:e.formData.orgAddr,callback:function(t){e.$set(e.formData,"orgAddr",t)},expression:"formData.orgAddr"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"组织邮编 :",prop:"orgPost"}},[r("el-input",{model:{value:e.formData.orgPost,callback:function(t){e.$set(e.formData,"orgPost",t)},expression:"formData.orgPost"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"组织电话 :",prop:"orgPhone"}},[r("el-input",{model:{value:e.formData.orgPhone,callback:function(t){e.$set(e.formData,"orgPhone",t)},expression:"formData.orgPhone"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"组织状态 :",prop:"orgStat"}},[r("el-radio-group",{model:{value:e.formData.orgStat,callback:function(t){e.$set(e.formData,"orgStat",t)},expression:"formData.orgStat"}},[r("el-radio",{attrs:{label:"1"}},[e._v("正常")]),e._v(" "),r("el-radio",{attrs:{label:"2"}},[e._v("禁用")]),e._v(" "),r("el-radio",{attrs:{label:"3"}},[e._v("注销")])],1)],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"组织描述 :",prop:"orgDesc"}},[r("el-input",{attrs:{type:"textarea",maxlength:"512","show-word-limit":""},model:{value:e.formData.orgDesc,callback:function(t){e.$set(e.formData,"orgDesc",t)},expression:"formData.orgDesc"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"创建用户 :",prop:"createdUser"}},[r("el-input",{attrs:{disabled:""},model:{value:e.formData.createdUser,callback:function(t){e.$set(e.formData,"createdUser",t)},expression:"formData.createdUser"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"创建时间 :",prop:"createdTime"}},[r("el-input",{attrs:{value:e.$utils.toDateString(e.formData.createdTime,"yyyy-MM-dd HH:mm:ss"),disabled:""}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"更新用户 :",prop:"updatedUser"}},[r("el-input",{attrs:{disabled:""},model:{value:e.formData.updatedUser,callback:function(t){e.$set(e.formData,"updatedUser",t)},expression:"formData.updatedUser"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"更新时间 :",prop:"updatedTime"}},[r("el-input",{attrs:{value:e.$utils.toDateString(e.formData.updatedTime,"yyyy-MM-dd HH:mm:ss"),disabled:""}})],1)],1)],1)],1),e._v(" "),r("flex-container",{staticClass:"footer",attrs:{justifyContent:"flex-end"}},[r("el-button",{on:{click:function(t){e.$emit("close")}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleUpdateData}},[e._v("确 定")])],1)],1)},staticRenderFns:[]},u={uuid:null,orgCode:"",orgPare:"",orgName:"",orgBrfName:"",orgDesc:"",orgMast:"",orgAddr:"",orgPost:"",orgPhone:"",orgStat:"1",orgOrde:0,createdUser:null,createdTime:0,updatedUser:null,updatedTime:0},g={name:"OrgMgr",components:{OrgEdit:r("VU/8")(d,m,!1,null,null,null).exports},data:function(){return{treeLoading:!1,isTreeExpand:!0,isSort:!1,showQuery:!1,queryForm:{orgName:"",orgBrfName:"",orgStat:"",updatedTime:[]},OrgAddVisible:!1,OrgEditVisible:!1,sysOrg:[],sysOrgKeys:[],editSysOrg:{},orgTreeProps:{children:"children",label:"orgName",key:"orgCode"}}},mounted:function(){this.doLoadTree()},methods:{handleSaveSysOrg:function(){var e=this;return s()(n.a.mark(function t(){var r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,0!==e.sysOrg[0].children.length){t.next=3;break}return t.abrupt("return");case 3:return e.treeLoading=!0,e.$utils.addTreeSort(e.sysOrg[0].children,"orgOrde"),(r=e.$utils.toTreeArray(e.sysOrg[0].children)).forEach(function(e){return delete e.children}),t.next=9,c.a.saveSysOrg(r);case 9:return t.sent,e.isSort=!1,t.next=13,e.doLoadTree();case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),e.$alert("数据提交失败 !");case 18:return t.prev=18,e.treeLoading=!1,t.finish(18);case 21:case"end":return t.stop()}},t,e,[[0,15,18,21]])}))()},handleQuery:function(){this.$refs.orgTree.filter(this.queryForm)},handleShowQuery:function(){this.showQuery=!this.showQuery},handleExpandSwitch:function(){this.isTreeExpand=!this.isTreeExpand,this.$utils.treeExpandSwitch(this.$refs.orgTree,this.isTreeExpand)},doLoadTree:function(){var e=this;return s()(n.a.mark(function t(){var r,a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.treeLoading=!0,t.next=4,c.a.getSysOrg();case 4:return r=t.sent,t.next=7,e.$utils.sleep(3e3);case 7:a=e.$utils.toArrayTree(r.data,{key:"orgCode",parentKey:"orgPare",children:"children",sortKey:"orgOrde"}),e.sysOrg=[{orgName:"组织机构树",orgBrfName:"ROOT",orgCode:"ROOT",children:a}],t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),e.$alert("数据加载失败 !");case 14:return t.prev=14,e.treeLoading=!1,t.finish(14);case 17:case"end":return t.stop()}},t,e,[[0,11,14,17]])}))()},doUpdataData:function(e){var t=this;return s()(n.a.mark(function r(){var a,o;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t.treeLoading=!0,a=[e],t.editSysOrg.orgStat!==e.orgStat&&"1"!==e.orgStat&&(o=t.$refs.orgTree.getNode(e.orgCode),t.$utils.eachTree(o.data.children,function(t){t.orgStat=e.orgStat,a.push(t)})),r.next=6,c.a.saveSysOrg(a);case 6:return r.next=8,t.doLoadTree();case 8:r.next=12;break;case 10:r.prev=10,r.t0=r.catch(0);case 12:return r.prev=12,t.treeLoading=!1,r.finish(12);case 15:case"end":return r.stop()}},r,t,[[0,10,12,15]])}))()},doAddButtonNode:function(e,t){this.editSysOrg=o()({},u,{orgPare:t.orgCode,createdTime:this.$utils.now(),updatedTime:this.$utils.now()}),this.OrgEditVisible=!0},doFilterNode:function(e,t){if("ROOT"===t.orgCode)return!0;var r=t.orgName.includes(e.orgName),a=t.orgBrfName.includes(e.orgBrfName),o=t.orgStat.includes(e.orgStat),i=!0;return e.updatedTime&&2===e.updatedTime.length&&(i=e.updatedTime[0].getTime()<=t.updatedTime&&t.updatedTime<=e.updatedTime[1].getTime()),r&&a&&o&&i},doAllowDropNode:function(e,t,r){var a=e.parent.id===t.parent.id&&"inner"!==r;return a&&(this.isSort=!0),a},doRemoveNode:function(e,t){var r=this;return s()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.doMessageBox();case 3:if(!t.uuid){e.next=6;break}return e.next=6,c.a.delSysOrg([t.uuid]);case 6:r.$refs.orgTree.remove(t[r.orgTreeProps.key]),r.isSort=!0,e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}},e,r,[[0,10]])}))()},doEditNode:function(e){this.editSysOrg=e,this.OrgEditVisible=!0},doMessageBox:function(e,t,r){return this.$confirm(e||"确定进行此操作!",t||"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:r||"warning"})},doRenderTreeContent:function(e,t){var r=this,a=t.node,o=t.data,i=(t.store,[]),n=e("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-plus",title:"添加按钮"},on:{click:function(e){r.doAddButtonNode(a,o),e.stopPropagation()}}}),l=e("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit",title:"编辑"},on:{click:function(e){r.doEditNode(o),e.stopPropagation()}}}),s=e("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete",title:"删除"},on:{click:function(e){r.doRemoveNode(a,o),e.stopPropagation()}}});o.children&&"ROOT"===o.orgCode?i.push(n):o.children&&"ROOT"!==o.orgCode&&(i.push(n),i.push(l),i.push(s));var c="icon-size-14";return 1!=o.orgStat&&"ROOT"!==o.orgCode&&(c+=" icon-color-danger"),1==o.orgStat&&"ROOT"!==o.orgCode&&(c+=" icon-color-info"),"ROOT"===o.orgCode&&(c+=" icon-color-primary"),e("flex-container",{attrs:{wrap:"nowrap",alignItems:"center",justifyContent:"space-between"}},[e("flex-item",{attrs:{alignItems:"center"}},[e("el-tooltip",{attrs:{content:o.orgCode,placement:"right"}},[e("span",{class:c},[a.label])])]),e("flex-item",{attrs:{alignItems:"center"},class:"margin-right-5"},[i])])}}},p={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("flex-container",{attrs:{direction:"column",wrap:"nowrap"}},[r("flex-item",{directives:[{name:"show",rawName:"v-show",value:e.showQuery,expression:"showQuery"}],staticClass:"margin-bottom-10"},[r("el-card",[r("flex-container",{attrs:{slot:"header",justifyContent:"space-between"},slot:"header"},[r("flex-item",{attrs:{alignItems:"center"}},[r("i",{staticClass:"el-icon-s-operation margin-right-6 font-size-16"}),e._v("查询参数\n        ")]),e._v(" "),r("flex-item",{attrs:{alignItems:"center"}},[r("el-button",{attrs:{type:"primary",size:"mini",circle:"",icon:"el-icon-search",title:"查询"},on:{click:e.handleQuery}}),e._v(" "),r("el-button",{attrs:{size:"mini",circle:"",plain:"",icon:"el-icon-refresh-left",title:"重置"},on:{click:function(t){e.$refs.queryForm.resetFields()}}})],1)],1),e._v(" "),r("el-form",{ref:"queryForm",staticClass:"form-style-line",attrs:{model:e.queryForm,"label-position":"right","label-width":"80px"}},[r("el-row",[r("col-pr",{attrs:{xs:24,sm:24,md:12,lg:12,xl:8}},[r("el-form-item",{attrs:{label:"组织名称 :",prop:"orgName"}},[r("el-input",{attrs:{maxlength:"10","show-word-limit":""},model:{value:e.queryForm.orgName,callback:function(t){e.$set(e.queryForm,"orgName",t)},expression:"queryForm.orgName"}})],1)],1),e._v(" "),r("col-pr",{attrs:{xs:24,sm:24,md:12,lg:12,xl:8}},[r("el-form-item",{attrs:{label:"组织简称 :",prop:"orgBrfName"}},[r("el-input",{attrs:{maxlength:"50","show-word-limit":""},model:{value:e.queryForm.orgBrfName,callback:function(t){e.$set(e.queryForm,"orgBrfName",t)},expression:"queryForm.orgBrfName"}})],1)],1),e._v(" "),r("col-pr",{attrs:{xs:24,sm:24,md:12,lg:12,xl:8}},[r("el-form-item",{attrs:{label:"组织状态 :",prop:"orgStat"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.queryForm.orgStat,callback:function(t){e.$set(e.queryForm,"orgStat",t)},expression:"queryForm.orgStat"}},[r("el-option",{attrs:{label:"正常",value:"1"}}),e._v(" "),r("el-option",{attrs:{label:"禁用",value:"2"}}),e._v(" "),r("el-option",{attrs:{label:"注销",value:"3"}})],1)],1)],1),e._v(" "),r("col-pr",{attrs:{xs:24,sm:24,md:12,lg:12,xl:8}},[r("el-form-item",{attrs:{label:"更新时间 :",prop:"updatedTime"}},[r("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.queryForm.updatedTime,callback:function(t){e.$set(e.queryForm,"updatedTime",t)},expression:"queryForm.updatedTime"}})],1)],1)],1)],1)],1)],1),e._v(" "),r("flex-item",{attrs:{grow:1}},[r("el-card",[r("flex-container",{attrs:{slot:"header",justifyContent:"space-between"},slot:"header"},[r("flex-item",{attrs:{alignItems:"center"}},[r("i",{staticClass:"icon-fa fa-sitemap margin-right-6 font-size-16"}),e._v(" "),r("span",{staticClass:"margin-right-4"},[e._v("系统组织")]),e._v(" "),e.isSort&&e.sysOrg.children&&e.sysOrg.sysOrg.length>0?r("el-tooltip",{attrs:{content:"排序已修改,请保存 !",placement:"right"}},[r("i",{staticClass:"el-icon-warning icon-color-danger"})]):e._e()],1),e._v(" "),r("flex-item",{attrs:{alignItems:"center"}},[r("el-button",{attrs:{loading:e.treeLoading,size:"mini",circle:"",icon:"icon-ali ali-gongju",title:"排序整理"},on:{click:e.handleSaveSysOrg}}),e._v(" "),r("el-button",{attrs:{loading:e.treeLoading,size:"mini",circle:"",icon:"el-icon-refresh",title:"刷新"},on:{click:e.doLoadTree}}),e._v(" "),r("el-button",{attrs:{loading:e.treeLoading,size:"mini",plain:"",circle:"",icon:e.isTreeExpand?"icon-ali ali-tuceng":"icon-ali ali-tuceng1",title:e.isTreeExpand?"全部折叠":"全部展开"},on:{click:e.handleExpandSwitch}}),e._v(" "),r("el-button",{attrs:{loading:e.treeLoading,size:"mini",plain:"",circle:"",icon:e.showQuery?"el-icon-caret-bottom":"el-icon-caret-top",title:e.showQuery?"隐藏查询面板":"显示查询面板"},on:{click:e.handleShowQuery}})],1)],1),e._v(" "),r("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],ref:"orgTree",attrs:{data:e.sysOrg,"node-key":e.orgTreeProps.key,props:e.orgTreeProps,"default-expand-all":"",draggable:"","allow-drop":e.doAllowDropNode,"render-content":e.doRenderTreeContent,"filter-node-method":e.doFilterNode}})],1)],1),e._v(" "),r("dialog-drag",{attrs:{title:"编辑数据",visible:e.OrgEditVisible},on:{"update:visible":function(t){e.OrgEditVisible=t}}},[r("span",{attrs:{slot:"title"},slot:"title"},[r("i",{staticClass:"el-icon-edit margin-right-4"}),e._v("编辑数据\n    ")]),e._v(" "),r("org-edit",{attrs:{initData:e.editSysOrg},on:{updataData:e.doUpdataData,close:function(t){e.OrgEditVisible=!1}}})],1)],1)},staticRenderFns:[]},f=r("VU/8")(g,p,!1,null,null,null);t.default=f.exports}});
//# sourceMappingURL=16.54b1b3a988004c882a74.js.map