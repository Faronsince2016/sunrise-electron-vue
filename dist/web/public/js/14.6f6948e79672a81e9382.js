webpackJsonp([14],{ZGWy:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("woOf"),o=r.n(a),l=r("Xxa5"),s=r.n(l),n=r("exGp"),i=r.n(n),c=r("JA1M"),u=function(e){return c.a.get("/usrm/userMgr/querySysUser",{params:e})},d=function(e){return c.a.delete("/usrm/userMgr/delSysUser/"+e)},m=function(e){return c.a.post("/usrm/userMgr/saveSysUser",e)},p=function(e){return c.a.put("/usrm/userMgr/userLock/"+e)},f=function(e){return c.a.put("/usrm/userMgr/userUnlock/"+e)},h=function(e){return c.a.put("/usrm/userMgr/userDest/"+e)},g=r("CWES"),v=r("lhVJ"),b={props:{initData:{type:Object}},inject:["orgTree","orgTreeProps"],data:function(){return{loading:!1,roles:[],formData:o()({},this.initData),formRules:{acName:[{required:!0,message:"请输入账户名称 !",trigger:"change"}],acStat:[{required:!0,message:"请选择账户状态 !",trigger:"change"}],orgUuid:[{required:!0,message:"请选择隶属组织 !",trigger:"change"}],roleUuids:[{required:!0,message:"请选择拥有角色 !",trigger:"change"}]}}},mounted:function(){this.formData.orgUuid&&this.loadRole(this.formData.orgUuid)},methods:{loadRole:function(e){var t=this;return i()(s.a.mark(function r(){var a;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t.loading=!0,r.next=4,v.a.getRoleByOrgUuid({orgUuid:e});case 4:a=r.sent,t.roles=a.data,r.next=10;break;case 8:r.prev=8,r.t0=r.catch(0);case 10:return r.prev=10,t.loading=!1,r.finish(10);case 13:case"end":return r.stop()}},r,t,[[0,8,10,13]])}))()},orgUuidChange:function(e){this.loadRole(e),this.formData.roleUuids=[]},handleUpdateData:function(){var e=this;return i()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$refs.editForm.validate();case 3:e.$emit("updataData",e.formData),e.$emit("close"),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}},t,e,[[0,7]])}))()}}},x={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("flex-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[r("el-form",{ref:"editForm",staticClass:"form-style-line",attrs:{model:e.formData,rules:e.formRules,"label-position":"right","label-width":"90px"}},[r("el-row",{attrs:{span:12}},[r("el-col",[r("el-form-item",{attrs:{label:"账户名称 :",prop:"acName"}},[r("el-input",{attrs:{maxlength:"10","show-word-limit":""},model:{value:e.formData.acName,callback:function(t){e.$set(e.formData,"acName",t)},expression:"formData.acName"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"账户状态 :",prop:"acStat"}},[r("dict-select",{attrs:{"dict-key":"AcStat",placeholder:"请选择",clearable:""},model:{value:e.formData.acStat,callback:function(t){e.$set(e.formData,"acStat",t)},expression:"formData.acStat"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"隶属组织 :",prop:"orgUuid"}},[r("el-cascader",{attrs:{options:e.orgTree,props:e.orgTreeProps,clearable:""},on:{change:e.orgUuidChange},model:{value:e.formData.orgUuid,callback:function(t){e.$set(e.formData,"orgUuid",t)},expression:"formData.orgUuid"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"拥有角色 :",prop:"roleUuids"}},[r("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.formData.roleUuids,callback:function(t){e.$set(e.formData,"roleUuids",t)},expression:"formData.roleUuids"}},e._l(e.roles,function(e){return r("el-option",{key:e.uuid,attrs:{label:e.roleName,value:e.uuid}})}))],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"初始密码 :",prop:"acPwd"}},[r("el-input",{attrs:{maxlength:"10","show-word-limit":""},model:{value:e.formData.acPwd,callback:function(t){e.$set(e.formData,"acPwd",t)},expression:"formData.acPwd"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"用户姓名 :",prop:"userName"}},[r("el-input",{attrs:{maxlength:"10","show-word-limit":""},model:{value:e.formData.userName,callback:function(t){e.$set(e.formData,"userName",t)},expression:"formData.userName"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"用户性别 :",prop:"userSex"}},[r("dict-select",{attrs:{"dict-key":"Sex",placeholder:"请选择",clearable:""},model:{value:e.formData.userSex,callback:function(t){e.$set(e.formData,"userSex",t)},expression:"formData.userSex"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"联系电话 :",prop:"userPhone"}},[r("el-input",{attrs:{maxlength:"10","show-word-limit":""},model:{value:e.formData.userPhone,callback:function(t){e.$set(e.formData,"userPhone",t)},expression:"formData.userPhone"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"出生日期 :",prop:"userBirthday"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.formData.userBirthday,callback:function(t){e.$set(e.formData,"userBirthday",t)},expression:"formData.userBirthday"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"邮箱地址 :",prop:"userEmail"}},[r("el-input",{attrs:{maxlength:"50","show-word-limit":""},model:{value:e.formData.userEmail,callback:function(t){e.$set(e.formData,"userEmail",t)},expression:"formData.userEmail"}})],1)],1),e._v(" "),e.formData.createdUser?[r("el-col",[r("el-form-item",{attrs:{label:"创建用户 :",prop:"createdUser"}},[r("el-input",{attrs:{disabled:""},model:{value:e.formData.createdUser,callback:function(t){e.$set(e.formData,"createdUser",t)},expression:"formData.createdUser"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"创建时间 :",prop:"createdTime"}},[r("el-input",{attrs:{value:e.$utils.toDateString(e.formData.createdTime,"yyyy-MM-dd HH:mm:ss"),disabled:""}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"更新用户 :",prop:"updatedUser"}},[r("el-input",{attrs:{disabled:""},model:{value:e.formData.updatedUser,callback:function(t){e.$set(e.formData,"updatedUser",t)},expression:"formData.updatedUser"}})],1)],1),e._v(" "),r("el-col",[r("el-form-item",{attrs:{label:"更新时间 :",prop:"updatedTime"}},[r("el-input",{attrs:{value:e.$utils.toDateString(e.formData.updatedTime,"yyyy-MM-dd HH:mm:ss"),disabled:""}})],1)],1)]:e._e()],2)],1),e._v(" "),r("flex-container",{staticClass:"footer",attrs:{justifyContent:"flex-end"}},[r("el-button",{on:{click:function(t){e.$emit("close")}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleUpdateData}},[e._v("确 定")])],1)],1)},staticRenderFns:[]},w={uuid:null,acName:"",acPwd:"",orgUuid:"",encSalt:"",acStat:"",lastLogDate:"",userName:"",userSex:"",userPhone:"",userEmail:"",userBirthday:"",createdUser:"",createdTime:"",updatedUser:"",updatedTime:"",roleUuids:[]},U={components:{UserMgrEdit:r("VU/8")(b,x,!1,null,null,null).exports},provide:function(){return{orgTree:this.orgTree,orgTreeProps:this.orgTreeProps}},data:function(){return{tableSelection:[],orgTree:[],orgTreeProps:{checkStrictly:!0,emitPath:!1,value:"uuid",label:"orgName"},orgViewProps:{checkStrictly:!0,emitPath:!1,value:"uuid",label:"orgName"},showUserDia:!1,userForm:{userName:"",userStat:"",userSex:"",orgUuid:""},lastLogDate:[],pageOptions:{pagerCount:5},editUser:{}}},mounted:function(){this.initOrgTree()},methods:{initOrgTree:function(){var e=this;return i()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g.a.getOrgTree();case 3:r=t.sent,e.$utils.eachTree(r.data,function(e){0===e.children.length&&delete e.children}),e.$utils.clear(e.orgTree),r.data.forEach(function(t){return e.orgTree.push(t)}),t.next=11;break;case 9:t.prev=9,t.t0=t.catch(0);case 11:case"end":return t.stop()}},t,e,[[0,9]])}))()},loadUser:function(e){return u(e)},handleQueryUser:function(){var e=o()({},this.userForm);this.lastLogDate&&2===this.lastLogDate.length&&o()(e,{lastLogDateStart:this.lastLogDate[0].getTime(),lastLogDateEnd:this.lastLogDate[1].getTime()}),this.$refs.userTable.loadData(e)},handleEditUser:function(e){this.editUser=o()({},e),this.showUserDia=!0},handleAddUser:function(){this.editUser=o()({},w),this.showUserDia=!0},handleDelUser:function(e){var t=this;return i()(s.a.mark(function r(){return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,d([e.uuid]);case 3:r.sent;case 4:return r.prev=4,t.handleQueryUser(),r.finish(4);case 7:case"end":return r.stop()}},r,t,[[0,,4,7]])}))()},handleUserLock:function(e,t){var r=this;return i()(s.a.mark(function a(){var o;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,o=[],e?r.tableSelection.forEach(function(e){o.push(e.uuid)}):o.push(t.uuid),a.next=5,p(o);case 5:a.next=9;break;case 7:a.prev=7,a.t0=a.catch(0);case 9:return a.prev=9,r.handleQueryUser(),a.finish(9);case 12:case"end":return a.stop()}},a,r,[[0,7,9,12]])}))()},handleUserUnlock:function(e,t){var r=this;return i()(s.a.mark(function a(){var o;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,o=[],e?r.tableSelection.forEach(function(e){o.push(e.uuid)}):o.push(t.uuid),a.next=5,f(o);case 5:a.next=9;break;case 7:a.prev=7,a.t0=a.catch(0);case 9:return a.prev=9,r.handleQueryUser(),a.finish(9);case 12:case"end":return a.stop()}},a,r,[[0,7,9,12]])}))()},handleUserDest:function(e,t){var r=this;return i()(s.a.mark(function a(){var o;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,r.$confirm("此操作会将用户置于最终状态且不可逆, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});case 3:return o=[],e?r.tableSelection.forEach(function(e){o.push(e.uuid)}):o.push(t.uuid),a.next=7,h(o);case 7:a.next=11;break;case 9:a.prev=9,a.t0=a.catch(0);case 11:return a.prev=11,r.handleQueryUser(),a.finish(11);case 14:case"end":return a.stop()}},a,r,[[0,9,11,14]])}))()},doUpdataUser:function(e){var t=this;return i()(s.a.mark(function r(){return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,m(e);case 3:return r.prev=3,t.handleQueryUser(),r.finish(3);case 6:case"end":return r.stop()}},r,t,[[0,,3,6]])}))()}}},D={render:function(){var e=this,t=this,r=t.$createElement,a=t._self._c||r;return a("flex-container",{attrs:{wrap:"nowrap",justifyContent:"space-between"}},[a("flex-item",{attrs:{grow:1,width:"100%"}},[a("el-card",[a("flex-container",{attrs:{slot:"header",justifyContent:"space-between"},slot:"header"},[a("flex-item",{attrs:{alignItems:"center"}},[a("i",{staticClass:"el-icon-s-custom margin-right-6 font-size-16"}),t._v("用户信息\n        ")]),t._v(" "),a("flex-item",{attrs:{alignItems:"center"}},[a("el-button",{attrs:{type:"primary",size:"mini",circle:"",icon:"el-icon-plus",title:"添加"},on:{click:t.handleAddUser}}),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",circle:"",icon:"el-icon-search",title:"查询"},on:{click:t.handleQueryUser}}),t._v(" "),a("el-button",{attrs:{size:"mini",circle:"",plain:"",icon:"el-icon-refresh-left",title:"重置"},on:{click:function(e){t.$refs.userForm.resetFields(),t.lastLogDate=[]}}}),t._v(" "),a("el-button",{attrs:{disabled:!t.tableSelection.length>0,size:"mini",circle:"",plain:"",icon:"icon-fa fa-lock",title:"批量锁定"},on:{click:function(e){t.handleUserLock(!0)}}}),t._v(" "),a("el-button",{attrs:{disabled:!t.tableSelection.length>0,size:"mini",circle:"",plain:"",icon:"icon-fa fa-unlock",title:"批量解锁"},on:{click:function(e){t.handleUserUnlock(!0)}}}),t._v(" "),a("el-button",{attrs:{disabled:!t.tableSelection.length>0,size:"mini",circle:"",plain:"",icon:"el-icon-switch-button",title:"批量注销"},on:{click:function(e){t.handleUserDest(!0)}}})],1)],1),t._v(" "),a("flex-container",{attrs:{direction:"column",wrap:"nowrap"}},[a("flex-item",{staticClass:"margin-bottom-10"},[a("el-form",{ref:"userForm",staticClass:"form-style-line",attrs:{model:t.userForm,"label-position":"right","label-width":"80px"}},[a("el-row",[a("col-pr",{attrs:{xs:24,sm:24,md:12,lg:6,xl:6}},[a("el-form-item",{attrs:{label:"账户名称 :",prop:"acName"}},[a("el-input",{attrs:{maxlength:"10","show-word-limit":""},model:{value:t.userForm.acName,callback:function(e){t.$set(t.userForm,"acName",e)},expression:"userForm.acName"}})],1)],1),t._v(" "),a("col-pr",{attrs:{xs:24,sm:24,md:12,lg:6,xl:6}},[a("el-form-item",{attrs:{label:"用户姓名 :",prop:"userName"}},[a("el-input",{attrs:{maxlength:"10","show-word-limit":""},model:{value:t.userForm.userName,callback:function(e){t.$set(t.userForm,"userName",e)},expression:"userForm.userName"}})],1)],1),t._v(" "),a("col-pr",{attrs:{xs:24,sm:24,md:12,lg:6,xl:6}},[a("el-form-item",{attrs:{label:"用户状态 :",prop:"acStat"}},[a("dict-select",{attrs:{"dict-key":"AcStat",placeholder:"请选择",clearable:""},model:{value:t.userForm.acStat,callback:function(e){t.$set(t.userForm,"acStat",e)},expression:"userForm.acStat"}})],1)],1),t._v(" "),a("col-pr",{attrs:{xs:24,sm:24,md:12,lg:6,xl:6}},[a("el-form-item",{attrs:{label:"隶属组织 :",prop:"orgUuid"}},[a("el-cascader",{attrs:{options:t.orgTree,props:t.orgTreeProps,clearable:""},model:{value:t.userForm.orgUuid,callback:function(e){t.$set(t.userForm,"orgUuid",e)},expression:"userForm.orgUuid"}})],1)],1),t._v(" "),a("col-pr",{attrs:{xs:24,sm:24,md:12,lg:6,xl:6}},[a("el-form-item",{attrs:{label:"用户性别 :",prop:"userSex"}},[a("dict-select",{attrs:{"dict-key":"Sex",placeholder:"请选择",clearable:""},model:{value:t.userForm.userSex,callback:function(e){t.$set(t.userForm,"userSex",e)},expression:"userForm.userSex"}})],1)],1),t._v(" "),a("col-pr",{attrs:{xs:24,sm:24,md:12,lg:12,xl:6}},[a("el-form-item",{attrs:{label:"最后登录 :",prop:"lastLogDate"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.lastLogDate,callback:function(e){t.lastLogDate=e},expression:"lastLogDate"}})],1)],1)],1)],1)],1),t._v(" "),a("flex-item",[a("data-table",{ref:"userTable",attrs:{border:"",index:"","auto-load":"","highlight-current-row":"","auto-update":"","column-button":"","csv-button":"",title:"Data Table","load-data-func":t.loadUser,pageOptions:t.pageOptions},on:{"selection-change":function(t){return e.tableSelection=t}}},[a("data-table-column",{attrs:{prop:"selection",type:"selection",align:"center",width:"50",fixed:"left"}}),t._v(" "),a("data-table-column",{attrs:{prop:"acName",label:"账户名称","show-overflow-tooltip":""}}),t._v(" "),a("data-table-column",{attrs:{prop:"acStat",label:"状态","show-overflow-tooltip":"",formatter:function(e){return t.$utils.tableColDictFormt("AcStat",e.acStat)}}}),t._v(" "),a("data-table-column",{attrs:{prop:"orgUuid",label:"隶属组织","show-overflow-tooltip":"",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-cascader",{staticClass:"cascader-table-disabled",attrs:{options:t.orgTree,value:e.row.orgUuid,props:t.orgViewProps,disabled:""}})]}}])}),t._v(" "),a("data-table-column",{attrs:{prop:"userName",label:"用户姓名","show-overflow-tooltip":""}}),t._v(" "),a("data-table-column",{attrs:{prop:"userSex",label:"性别","show-overflow-tooltip":"",formatter:function(e){return t.$utils.tableColDictFormt("Sex",e.userSex)}}}),t._v(" "),a("data-table-column",{attrs:{prop:"userPhone",label:"联系电话","show-overflow-tooltip":""}}),t._v(" "),a("data-table-column",{attrs:{prop:"userEmail",label:"邮件","show-overflow-tooltip":""}}),t._v(" "),a("data-table-column",{attrs:{prop:"userBirthday",label:"出生日期","show-overflow-tooltip":"",formatter:t.$utils.tableColTimeFormt}}),t._v(" "),a("data-table-column",{attrs:{prop:"lastLogDate",label:"最后登录","show-overflow-tooltip":"",formatter:t.$utils.tableColTimeFormt}}),t._v(" "),a("data-table-column",{attrs:{prop:"op",label:"操作",align:"center",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{disabled:"3"===e.row.acStat,type:"text",size:"mini",icon:"el-icon-edit",title:"编辑"},on:{click:function(r){t.handleEditUser(e.row)}}}),t._v(" "),a("el-button",{attrs:{disabled:"3"===e.row.acStat,type:"text",size:"mini",icon:"el-icon-delete",title:"删除"},on:{click:function(r){t.handleDelUser(e.row)}}}),t._v(" "),a("el-button",{attrs:{disabled:"2"===e.row.acStat||"3"===e.row.acStat,type:"text",size:"mini",icon:"icon-fa fa-lock",title:"锁定"},on:{click:function(r){t.handleUserLock(!1,e.row)}}}),t._v(" "),a("el-button",{attrs:{disabled:"1"===e.row.acStat||"3"===e.row.acStat,type:"text",size:"mini",icon:"icon-fa fa-unlock",title:"解锁"},on:{click:function(r){t.handleUserUnlock(!1,e.row)}}}),t._v(" "),a("el-button",{attrs:{disabled:"3"===e.row.acStat,type:"text",size:"mini",icon:"el-icon-switch-button",title:"注销"},on:{click:function(r){t.handleUserDest(!1,e.row)}}})]}}])})],1)],1)],1)],1)],1),t._v(" "),a("dialog-drag",{attrs:{title:"用户信息编辑",visible:t.showUserDia},on:{"update:visible":function(e){t.showUserDia=e}}},[a("span",{attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"el-icon-edit margin-right-4"}),t._v("用户信息编辑\n    ")]),t._v(" "),a("user-mgr-edit",{attrs:{initData:t.editUser},on:{updataData:t.doUpdataUser,close:function(e){t.showUserDia=!1}}})],1)],1)},staticRenderFns:[]},k=r("VU/8")(U,D,!1,null,null,null);t.default=k.exports},lhVJ:function(e,t,r){"use strict";var a=r("JA1M");t.a={saveSysRole:function(e){return a.a.post("/usrm/roleMgr/saveSysRole",e)},querySysRole:function(e){return a.a.get("/usrm/roleMgr/querySysRole",{params:e})},delSysRole:function(e){return a.a.delete("/usrm/roleMgr/delSysRole/"+e)},getSelectPerm:function(e){return a.a.get("/usrm/roleMgr/getSelectPerm",{params:e})},getRoleByOrgUuid:function(e){return a.a.get("/usrm/roleMgr/getRoleByOrgUuid",{params:e})}}}});
//# sourceMappingURL=14.6f6948e79672a81e9382.js.map